# AI_SQL_Promter & AI_SQL_Composer — генерация SQL и форматирование результатов

Этот модуль содержит два ключевых класса:  
- **AI_SQL_Promter** — преобразует пользовательский запрос на естественном языке в SQL.  
- **AI_SQL_Composer** — превращает результат SQL-запроса в человекочитаемый ответ с разметкой Markdown.  

Оба класса используют **OpenAI API** для работы с LLM.

## Ключевые особенности

- **AI_SQL_Promter**
  - Принимает описание схемы БД (`set_db_summary`).
  - Формирует системный промт, который заставляет модель генерировать **только** `SELECT`-запросы в формате JSON.
  - Блокирует попытки удаления/изменения данных (`DELETE`, `UPDATE`, `INSERT` → `status=failed`).
  - Возвращает структурированный JSON с ключами `status` и `sql`.

- **AI_SQL_Composer**
  - Форматирует «сырые» результаты SQL в таблицы, списки и удобные для чтения markdown-блоки.
  - Автоматически добавляет заголовки, пояснения и форматирует числа и даты.
  - Превращает идентификаторы в имена, если это возможно.

## Пример использования
Запрос пользователя: 
```
выведи в виде таблицы мои данные
```
Ответ AI_SQL_Promter: 
```sql
SELECT first_name, last_name, username, email, position, is_manager, is_active, created_at, updated_at FROM users WHERE id = 1320
```
Ответ AI_SQL_Composer: <br>
```
### Ваши данные

| Параметр | Значение |
|----------|----------|
| **Имя** | Светлана |
| **Фамилия** | Орлова |
| **Логин** | svetlana_orlova_626200 |
| **Email** | svetlana.orlova.777200@company.ru |
| **Должность** | Маркетолог |
| **Руководитель** | Нет |
| **Статус аккаунта** | Активен |
```

## **[На главную](../../README.md)** 